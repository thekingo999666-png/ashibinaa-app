<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>åº—å†…æ³¨æ–‡ - ã‚ã—ã³ãªã</title>

<style>
/* ===============================
   å…¨ä½“ãƒ†ãƒ¼ãƒ
================================*/
body {
  margin: 0;
  padding: 0;
  background: #0b0c10;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Hiragino Sans", "Yu Gothic";
}

/* ===============================
   ãƒ˜ãƒƒãƒ€ãƒ¼
================================*/
header {
  background: linear-gradient(90deg,#0a0f1c,#0b3048 40%,#0a0f1c);
  padding: 16px;
  text-align: center;
  font-size: 1.5rem;
  font-weight: bold;
  border-bottom: 2px solid #1ba7d9;
  text-shadow: 0 0 6px rgba(27,167,217,0.6);
}

/* ===============================
   å¤§ã‚«ãƒ†ã‚´ãƒª
================================*/
.category-card {
  margin: 16px;
  padding: 18px;
  background: radial-gradient(circle at top,#1b3b52,#0c1117);
  border: 2px solid #e6c15d;
  border-radius: 14px;
  font-size: 1.35rem;
  cursor: pointer;
  text-align: center;
  transition: 0.25s;
}
.category-card:hover {
  transform: translateY(-3px);
}

/* ===============================
   ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª
================================*/
.subcategory {
  margin: 10px 16px;
  padding: 14px;
  border-left: 5px solid #e6c15d;
  background: #0d141b;
  border-radius: 6px;
  font-size: 1.2rem;
  cursor: pointer;
}
.sub-box {
  display: none;
  margin: 6px 16px 14px 16px;
  padding: 10px;
  background: #0a0f14;
  border-radius: 10px;
}

/* ===============================
   å•†å“è¡Œ
================================*/
.item-row {
  padding: 14px;
  border-bottom: 1px solid #1d2932;
  display: flex;
  justify-content: space-between;
  cursor: pointer;
}
.item-row:hover {
  background: rgba(27,167,217,0.15);
}
.qty {
  background: linear-gradient(120deg,#e6c15d,#b8923b);
  color: #1a1a1a;
  padding: 4px 10px;
  border-radius: 8px;
  min-width: 32px;
  text-align: center;
  font-weight: bold;
  transition: 0.15s;
}

/* ===============================
   å›ºå®šæ³¨æ–‡ãƒœã‚¿ãƒ³
================================*/
#orderButton {
  position: fixed;
  bottom: 0; left: 0; right: 0;
  height: 60px;
  background: linear-gradient(90deg,#0a6fa9,#12a8d9,#0a6fa9);
  border-top: 2px solid #e6c15d;
  text-align: center;
  line-height: 60px;
  font-size: 1.4rem;
  font-weight: bold;
  cursor: pointer;
  z-index: 5000;
}

/* ===============================
   å¸­é¸æŠãƒ¢ãƒ¼ãƒ€ãƒ«
================================*/
#seatModal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  backdrop-filter: blur(6px);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 6000;
}
#seatBox {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(230,193,93,0.4);
  padding: 22px;
  width: 80%;
  border-radius: 16px;
  text-align: center;
}
.seat-btn {
  width: 100%;
  padding: 14px;
  font-size: 1.15rem;
  margin: 6px 0;
  background: linear-gradient(120deg,#0a6fa9,#12a8d9);
  border-radius: 10px;
  border: 1px solid #e6c15d;
  color: white;
  font-weight: bold;
}

/* ===============================
   æ³¨æ–‡å®Œäº†æ¼”å‡º
================================*/
#doneBanner {
  position: fixed;
  top: 30%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(255,255,255,0.15);
  padding: 20px 30px;
  border-radius: 12px;
  text-align: center;
  font-size: 1.4rem;
  display: none;
  backdrop-filter: blur(6px);
  border: 1px solid #e6c15d;
  z-index: 7000;
}

</style>
</head>
<body>

<header>åº—å†…æ³¨æ–‡ - ã‚ã—ã³ãªã</header>

<!-- ===============================
     å¸­é¸æŠï¼ˆæœ€åˆã«å¿…ãšè¡¨ç¤ºï¼‰
================================-->
<div id="seatModal">
  <div id="seatBox">
    <h2>å¸­ã‚’é¸æŠã—ã¦ãã ã•ã„</h2>
    <button class="seat-btn" onclick="selectSeat('ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼1')">ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼1</button>
    <button class="seat-btn" onclick="selectSeat('ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼2')">ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼2</button>
    <button class="seat-btn" onclick="selectSeat('ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼3')">ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼3</button>
    <button class="seat-btn" onclick="selectSeat('ãƒ†ãƒ¼ãƒ–ãƒ«1')">ãƒ†ãƒ¼ãƒ–ãƒ«1</button>
    <button class="seat-btn" onclick="selectSeat('ãƒ†ãƒ¼ãƒ–ãƒ«2')">ãƒ†ãƒ¼ãƒ–ãƒ«2</button>
    <button class="seat-btn" onclick="selectSeat('ã‚¹ã‚¿ãƒ³ãƒ‰1')">ã‚¹ã‚¿ãƒ³ãƒ‰1</button>
    <button class="seat-btn" onclick="selectSeat('ã‚¹ã‚¿ãƒ³ãƒ‰2')">ã‚¹ã‚¿ãƒ³ãƒ‰2</button>
    <button class="seat-btn" onclick="selectSeat('åº§æ•·')">åº§æ•·</button>
  </div>
</div>

<!-- æ³¨æ–‡å®Œäº†æ¼”å‡º -->
<div id="doneBanner">âœ¨ ã”æ³¨æ–‡ã‚’é€ä¿¡ã—ã¾ã—ãŸï¼ âœ¨</div>

<!-- ===============================
     ãƒ¡ãƒ‹ãƒ¥ãƒ¼å…¨ä½“
================================-->
<div id="menuContainer" style="display:none; padding-bottom:80px;">


<!-- ========== ãƒ•ãƒ¼ãƒ‰ ========== -->
<div class="category-card" onclick="toggleMain('food')">ğŸ½ ãƒ•ãƒ¼ãƒ‰</div>
<div id="food" class="main-box">

  <!-- ã‚ªã‚¹ã‚¹ãƒ¡ -->
  <div class="subcategory" onclick="toggleSub('osusume')">â­ ã‚ªã‚¹ã‚¹ãƒ¡</div>
  <div id="osusume" class="sub-box">
    <div class="item-row" onclick="addItem('çŸ³å£ç‰›ãƒãƒ³ãƒãƒ¼ã‚°','ishigaki')">çŸ³å£ç‰›ãƒãƒ³ãƒãƒ¼ã‚° <span id="qty-ishigaki" class="qty">0</span></div>

    <div class="item-row" onclick="addItem('å³¶ã‚‰ã£ãã‚‡é¤ƒå­','gyoza')">å³¶ã‚‰ã£ãã‚‡é¤ƒå­ <span id="qty-gyoza" class="qty">0</span></div>

    <div class="item-row" onclick="addItem('ã‚‚ãšãã‚­ãƒ ãƒ','mozuku')">ã‚‚ãšãã‚­ãƒ ãƒ <span id="qty-mozuku" class="qty">0</span></div>

    <div class="item-row" onclick="addItem('ãŒã˜ã‚…ã‚«ãƒ¬ãƒ¼','gaju')">ãŒã˜ã‚…ã‚«ãƒ¬ãƒ¼ <span id="qty-gaju" class="qty">0</span></div>
  </div>


  <!-- ã•ã£ã±ã‚Š -->
  <div class="subcategory" onclick="toggleSub('sappari')">ã•ã£ã±ã‚Š</div>
  <div id="sappari" class="sub-box">
    <div class="item-row" onclick="addItem('å³¶ã‚‰ã£ãã‚‡','rakyo')">å³¶ã‚‰ã£ãã‚‡ <span id="qty-rakyo" class="qty">0</span></div>
    <div class="item-row" onclick="addItem('æµ·ã¶ã©ã†','uni')">æµ·ã¶ã©ã† <span id="qty-uni" class="qty">0</span></div>
  </div>

  <!-- æšã’ç‰© -->
  <div class="subcategory" onclick="toggleSub('fry')">æšã’ç‰©</div>
  <div id="fry" class="sub-box">
    <div class="item-row" onclick="addItem('é¶ã®å”æšã’','karaage')">é¶ã®å”æšã’ <span class="qty" id="qty-karaage">0</span></div>
    <div class="item-row" onclick="addItem('å¤©ã·ã‚‰3ç¨®','temp3')">å¤©ã·ã‚‰3ç¨® <span class="qty" id="qty-temp3">0</span></div>
  </div>

  <!-- ã”é£¯ -->
  <div class="subcategory" onclick="toggleSub('rice')">ã”é£¯ã‚‚ã®</div>
  <div id="rice" class="sub-box">
    <div class="item-row" onclick="addItem('ãŒã˜ã‚…ä¸¼','gajudon')">ãŒã˜ã‚…ä¸¼ <span class="qty" id="qty-gajudon">0</span></div>
    <div class="item-row" onclick="addItem('ãƒãƒ¼ã‚ºãƒªã‚¾ãƒƒãƒˆ','cheese_riso')">ãƒãƒ¼ã‚ºãƒªã‚¾ãƒƒãƒˆ <span class="qty" id="qty-cheese_riso">0</span></div>
  </div>

</div>


<!-- ========== ãƒ‰ãƒªãƒ³ã‚¯ ========== -->
<div class="category-card" onclick="toggleMain('drink')">ğŸ¹ ãƒ‰ãƒªãƒ³ã‚¯</div>

<div id="drink" class="main-box">

  <div class="subcategory" onclick="toggleSub('beer')">ãƒ“ãƒ¼ãƒ«</div>
  <div id="beer" class="sub-box">
    <div class="item-row" onclick="addItem('ç”Ÿãƒ“ãƒ¼ãƒ«','nama')">ç”Ÿãƒ“ãƒ¼ãƒ« <span class="qty" id="qty-nama">0</span></div>
  </div>

  <div class="subcategory" onclick="toggleSub('shot')">ã‚·ãƒ§ãƒƒãƒˆ / ãƒ†ã‚­ãƒ¼ãƒ©</div>
  <div id="shot" class="sub-box">
    <div class="item-row" onclick="addItem('ãƒ¬ãƒã‚µãƒ‰1800ï¼ˆãƒ†ã‚­ãƒ¼ãƒ©ï¼‰','repo')">ãƒ¬ãƒã‚µãƒ‰1800 <span class="qty" id="qty-repo">0</span></div>
    <div class="item-row" onclick="addItem('ã©ãªã‚“','donan')">ã©ãªã‚“ <span class="qty" id="qty-donan">0</span></div>
  </div>

</div>

</div>


<!-- å›ºå®šæ³¨æ–‡ãƒœã‚¿ãƒ³ -->
<div id="orderButton" onclick="submitOrder()">æ³¨æ–‡ã™ã‚‹</div>



<script>
/* ===============================
   å¸­é¸æŠ
================================*/
let seat = "";
let order = {};

function selectSeat(s) {
  seat = s;
  document.getElementById("seatModal").style.display = "none";
  document.getElementById("menuContainer").style.display = "block";
}

/* ===============================
   å¤§ã‚«ãƒ†ã‚´ãƒªè¡¨ç¤ºåˆ‡æ›¿
================================*/
function toggleMain(id) {
  const box = document.getElementById(id);
  box.style.display = box.style.display === "block" ? "none" : "block";
}

/* ===============================
   ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªè¡¨ç¤ºåˆ‡æ›¿
================================*/
function toggleSub(id) {
  const box = document.getElementById(id);
  box.style.display = box.style.display === "block" ? "none" : "block";
}

/* ===============================
   ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ 
================================*/
function addItem(name, id) {
  if (!order[id]) order[id] = { name: name, qty: 0 };

  order[id].qty++;

  const qtyEl = document.getElementById("qty-" + id);
  qtyEl.innerText = order[id].qty;
  qtyEl.style.transform = "scale(1.25)";
  setTimeout(() => qtyEl.style.transform = "scale(1)", 150);
}

/* ===============================
   æ³¨æ–‡å†…å®¹ä½œæˆï¼ˆãƒ•ãƒ¼ãƒ‰ã¨ãƒ‰ãƒªãƒ³ã‚¯åˆ†é¡ï¼‰
================================*/
function buildOrderText() {
  let text = `ã€å¸­ã€‘${seat}\n\n`;

  let food = "ã€ãƒ•ãƒ¼ãƒ‰ã€‘\n";
  let drink = "ã€ãƒ‰ãƒªãƒ³ã‚¯ã€‘\n";

  Object.keys(order).forEach(id => {
    const item = order[id];
    if (item.qty > 0) {
      if (isDrink(id)) drink += `${item.name} Ã— ${item.qty}\n`;
      else food += `${item.name} Ã— ${item.qty}\n`;
    }
  });

  return food + "\n" + drink;
}

/* ãƒ‰ãƒªãƒ³ã‚¯åˆ¤å®šï¼ˆIDã§åˆ¤å®šï¼‰ */
function isDrink(id) {
  return ["nama","repo","donan"].includes(id);
}

/* ===============================
   æ³¨æ–‡é€ä¿¡
================================*/
async function submitOrder() {
  if (!seat) return alert("å¸­ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“");

  const text = buildOrderText();

  await fetch("https://odd-shape-3114.ashibinaa-izakaya.workers.dev/order", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify({ text })
  });

  // å®Œäº†æ¼”å‡º
  const banner = document.getElementById("doneBanner");
  banner.style.display = "block";
  setTimeout(()=> banner.style.display="none", 1800);

  resetOrders();
}

/* ===============================
   æ³¨æ–‡ãƒªã‚»ãƒƒãƒˆ
================================*/
function resetOrders() {
  Object.values(order).forEach(item => {
    const id = Object.keys(order).find(key => order[key]===item);
    document.getElementById("qty-"+id).innerText = 0;
  });
  order = {};
}

</script>
</body>
</html>
